"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[829],{70829:function(e,s,t){t.d(s,{Z:function(){return V}});var r,n=t(85893),a=t(14323),i=t(84658),o=t(5572),l=t(3436),d=t(91173),c=t(94404),x=t(23735),m=t(45830),h=t(8583),u=t(67294);let v=e=>{let{sharedConversationId:s}=e,{isDesktop:t}=(0,d.Z)(),[r,i]=(0,u.useState)(!1),o=async()=>(0,a.vQ)({text:"".concat((0,a.pi)(),"conversation/").concat(s),onSuccess:async()=>{i(!0),setTimeout(()=>{i(!1)},2e3)},onError:e=>(0,h.J)("Copy Link failed!")});return(0,n.jsx)(l.Z,{disabled:r||!t,content:"Copy Conversation Link",children:(0,n.jsxs)("button",{className:(0,a.AK)("flex items-center rounded bg-none",t?"gap-1.5 text-xs text-primary-300":"flex gap-2 w-full items-center justify-start space-x-2 rounded-md p-2 text-left text-sm transition-all duration-75 hover:bg-primary-600 active:bg-primary-650"),onClick:async()=>{await o(),await m.x.countConversationShare({sharedConversationId:s})},children:[r?(0,n.jsx)(x.NO,{size:t?"sm":"md",color:"green",strokeWidth:1.5}):(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:(0,a.AK)(t?"w-4 h-4":"w-5 h-5"),children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"})}),r?"Link copied!":"Share"]})})},p=e=>{let{snapshot:s}=e,{isDesktop:t}=(0,d.Z)();return(0,n.jsx)("div",{className:"border-t border-primary-800 p-4",children:(0,n.jsxs)("div",{className:"flex w-full gap-2 ",children:[(0,n.jsx)("div",{className:"flex-grow",children:s.views>-1&&(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(l.Z,{content:"View Count",children:(0,n.jsxs)("div",{className:"text-primary-300 text-sm flex gap-1 items-center select-none",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})," ",s.views," views"]})})})}),(0,n.jsx)("div",{className:"flex items-center justify-end",children:t&&s.shares>-1&&(0,n.jsx)(v,{sharedConversationId:s.id})}),c._R&&s.shares>-1&&(0,n.jsxs)("div",{className:"text-primary-300 text-sm flex gap-1 items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"})}),s.shares]})]})})};var j=t(67091);(r||(r={})).ADMIN="Admin",Set.prototype.equals=function(e){return this.size===e.size&&[...this].every(s=>e.has(s))},Set.prototype.difference=function(e){return new Set(Array.from(this).filter(s=>!e.has(s)))};var f=t(21805),g=t(30381),w=t.n(g),y=t(41664),N=t.n(y),b=t(35377),k=t(78133),C=t(21469);let L=e=>{let{openPopover:s,setOpenPopover:t,sharedConversationId:r,children:i,mutate:o}=e,{isDesktop:l}=(0,d.Z)(),[c,v]=(0,u.useState)(!1);return(0,n.jsx)(k.Z,{content:(0,n.jsxs)("div",{className:(0,a.AK)("relative","rounded-xl p-4 flex flex-col gap-4 w-64 mx-auto"),children:[(0,n.jsx)("div",{className:"text-primary-50 font-medium text-center flex items-start gap-2 justify-center",children:"Violates Content Policy?"}),l&&(0,n.jsx)("div",{className:"absolute top-0 right-0 p-2 select-none text-primary-300 hover:text-primary-50 transition duration-200 ease-in-out",children:(0,n.jsx)(C.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"cursor-pointer",onClick:()=>t(!1),children:(0,n.jsx)(x.bM,{size:"sm"})})}),(0,n.jsx)("div",{className:"w-full flex gap-2 justify-evenly",children:c?(0,n.jsx)(b.Z,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>{v(!0),m.x.flagSharedConversation({sharedConversationId:r}).then(e=>{e&&e.ok?(o&&o(),t(!1),(0,h.Q)("Successfully flagged conversation")):(0,h.J)("Something went wrong"),v(!1)})},className:"w-full bg-red-500 hover:bg-red-600 rounded-lg py-1 transition duration-200 ease-in-out",children:"Yes"}),(0,n.jsx)("button",{onClick:()=>t(!1),className:"w-full bg-green-500 hover:bg-green-600 rounded-lg py-1 transition duration-200 ease-in-out",children:"No"})]})})]}),openPopover:s,setOpenPopover:t,children:(0,n.jsx)("div",{onClick:()=>t(!s),children:i})})},Z=e=>{let{sharedConversationId:s,mutate:t}=e,[r,a]=(0,u.useState)(!1);return(0,n.jsx)(L,{openPopover:r,setOpenPopover:a,sharedConversationId:s,mutate:t,children:(0,n.jsxs)("div",{className:"text-xs font-bold cursor-pointer text-red-500 hover:text-red-600 active:text-red-800 flex items-center gap-1 transition duration-200 ease-in-out",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),"flag"]})})};var I=t(11163);let z=e=>{let{loading:s,setLoading:t,setOpenPopover:r,sharedConversationId:a,userId:i}=e,o=(0,I.useRouter)();return(0,n.jsxs)("button",{onClick:async()=>{t(!0),await m.x.deleteSharedConversation({sharedConversationId:a,userId:i}),r(!1),t(!1),o.reload()},disabled:s,className:"flex gap-2 w-full items-center justify-start space-x-2 rounded-md p-2 text-left text-sm transition-all duration-75 hover:bg-primary-600 active:bg-primary-650",children:[s?(0,n.jsx)("div",{className:"flex items-center justify-center w-5 h-5",children:(0,n.jsx)(b.Z,{small:!0})}):S,"Delete"]})},S=(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),M=e=>{let{openPopover:s,setOpenPopover:t,sharedConversationId:r,userId:i,children:o}=e,{isDesktop:l}=(0,d.Z)(),[c,x]=(0,u.useState)(!1);return(0,n.jsx)(k.Z,{content:(0,n.jsxs)("div",{className:(0,a.AK)("relative","rounded-xl p-1 flex flex-col gap-4 w-full md:w-44 mx-auto"),children:[!l&&(0,n.jsx)(v,{sharedConversationId:r}),(0,n.jsx)(z,{loading:c,setLoading:x,setOpenPopover:t,sharedConversationId:r,userId:i})]}),openPopover:s,setOpenPopover:t,children:(0,n.jsx)("div",{onClick:()=>t(!s),children:o})})},A=e=>{let{sharedConversationId:s,userId:t,isOwner:r}=e,[a,i]=(0,u.useState)(!1);return t&&r?(0,n.jsx)(M,{openPopover:a,setOpenPopover:i,sharedConversationId:s,userId:t,children:(0,n.jsx)("button",{className:"flex items-center",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-primary-300 hover:text-primary-0 active:text-primary-400 transition duration-200 ease-in-out",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"})})})}):(0,n.jsx)(n.Fragment,{})},P=e=>{let{view:s,snapshot:t,mutate:a}=e,{session:i}=(0,f.t)(),{userId:o}=(0,j.Z)();return"service"===s?(0,n.jsx)("div",{className:"border-b border-primary-800 p-4",children:(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)("div",{className:"flex gap-2 items-center ",children:(0,n.jsx)(l.Z,{content:"View Chatbot",children:(0,n.jsx)(N(),{href:"/chat/".concat(t.chatbot.id),children:(0,n.jsx)("div",{className:"line-clamp-1 active:text-primary-50 hover:text-primary-300 transition ease-in-out duration-200 text-xs md:text-sm text-primary-400",children:t.chatbot.name})})})})})}):(0,n.jsxs)("div",{className:"border-b border-primary-700 p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between gap-2 items-center",children:[(0,n.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,n.jsx)(B,{onFeed:"feed"===s,snapshot:t})}),(0,n.jsxs)("div",{className:"flex-grow flex gap-2 items-center justify-end",children:[(null==i?void 0:i.roles)&&(null==i?void 0:i.roles.includes(r.ADMIN))&&(0,n.jsx)(Z,{sharedConversationId:t.id,mutate:a}),t.isOwner&&(0,n.jsx)(A,{isOwner:t.isOwner,sharedConversationId:t.id,userId:null!=o?o:void 0})]})]}),(0,n.jsx)("div",{className:"flex",children:(0,n.jsxs)("div",{className:"flex gap-2 items-center ",children:[(0,n.jsx)(l.Z,{content:"View Profile",children:(0,n.jsx)(N(),{href:"/profile/".concat(t.createdByUsername),children:(0,n.jsxs)("div",{className:"line-clamp-1 text-primary-400 hover:text-primary-300 transition duration-200 ease-in-out text-xs md:text-sm",children:["@",t.createdByUsername]})})}),(0,n.jsx)("div",{className:"rounded-full h-1 w-1 bg-primary-500"}),(0,n.jsx)(l.Z,{content:"View Chatbot",children:(0,n.jsx)(N(),{href:"/chat/".concat(t.chatbot.id),children:(0,n.jsx)("div",{className:"line-clamp-1 active:text-primary-50 hover:text-primary-300 transition ease-in-out duration-200 text-xs md:text-sm text-primary-400",children:t.chatbot.name})})}),(0,n.jsx)("div",{className:"rounded-full h-1 w-1 bg-primary-500"}),(0,n.jsx)("div",{className:"line-clamp-1 text-primary-500 text-xs select-none",children:w()(t.createdAt).fromNow()})]})})]})},B=e=>{let{snapshot:s,onFeed:t}=e;return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)(N(),{href:"/conversation/".concat(s.id),className:"w-full",children:(0,n.jsx)("div",{className:"w-full  select-none text-lg cursor-pointer active:text-primary-50 transition-all ease-in-out duration-200",children:(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)(l.Z,{content:"View Chat",disabled:!t,children:(0,n.jsx)("div",{className:"line-clamp-1",children:s.title})})})})}):(0,n.jsx)("div",{className:"text-base md:text-lg select-none line-clamp-1",children:s.title})})};var O=t(52934);let K=e=>{let{view:s,sharedConversationDetailed:t,mutate:r}=e;return(0,n.jsx)("div",{className:(0,a.AK)("mx-auto w-full"),children:(0,n.jsxs)("div",{className:(0,a.AK)("bg-white dark:bg-primary-800 border border-primary-800 rounded-lg shadow-sm","feed"===s?"hover:bg-primary-900 dark:hover:bg-primary-700 group/snapshot transition duration-200 ease-in-out":""),children:[(0,n.jsx)(P,{view:s,snapshot:t,mutate:r}),(0,n.jsxs)("div",{className:(0,a.AK)("p-4 flex flex-col gap-4","bg-primary-900","service"===s?"rounded-b-lg":"","feed"===s?"h-[60vh] max-h-[700px] overflow-auto group-hover/snapshot:bg-primary-900-fade/80 transition duration-200 ease-in-out":"overflow-auto"),children:[t.messages.map((e,s)=>{if(e.message)return"bot"===e.sender?(0,n.jsx)(i.Z,{message:e.message,conversationItemId:e.conversationItemId,emoji:t.chatbot.emoji||void 0},s):(0,n.jsx)(o.Z,{message:e.message,image:t.creatorImage||void 0,username:t.createdByUsername||void 0},s)}),t.messages.length>=2*O.to&&"feed"===s&&(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)(N(),{href:"/conversation/".concat(t.id),children:(0,n.jsx)("button",{className:"px-4 py-2 rounded-lg bg-primary-700 hover:bg-primary-650-fade/60 active:bg-primary-800 transition-colors duration-200 ease-in-out shadow-2xl",children:"View full conversation"})})})]}),"service"!==s&&(0,n.jsx)(p,{snapshot:t})]})})};var V=K}}]);